#!/bin/sh

read -r PAM_PASS

if [ -f /home/"$PAM_USER"/.gnupg/pam_exec-gpg ]; then
    printf "%s" "$PAM_PASS" | /usr/lib/gnupg/gpg-preset-passphrase --passphrase "$(cat)" --preset "$(cat /home/"$PAM_USER"/.gnupg/pam_exec-gpg)"
fi

exit 0
